<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uçak Savaş Oyunu</title>
<style>
body {
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: #111; 
    font-family: Arial, sans-serif;
    touch-action: none;
}

#gameContainer {
    position: relative;
    width: 90vw;  /* ekran genişliğinin %90'ı */
    height: 70vh; /* ekran yüksekliğinin %70'i */
    max-width: 800px;
    max-height: 600px;
    overflow: hidden;
    border: 3px solid #fff;
    border-radius: 10px;
    background: linear-gradient(to top, #87CEFA 0%, #B0E0E6 100%);
    touch-action: none;
}

#player {
    position: absolute;
    bottom: 3%;
    left: 50%;
    transform: translateX(-50%);
    width: 6%;  /* konteynerin genişliğine göre */
    height: auto;
    max-width: 50px;
    background-image: url('player.png');
    background-size: contain;
    background-repeat: no-repeat;
}

.enemy {
    position: absolute;
    width: 6%;
    height: auto;
    max-width: 50px;
    background-image: url('enemy.png');
    background-size: contain;
    background-repeat: no-repeat;
}

.bullet {
    position: absolute;
    width: 0.6%;
    height: 2.5%;
    background-color: red;
}

#scoreBoard, #levelBoard, #livesBoard {
    color: white;
    font-size: 4vw;
    position: absolute;
}

#scoreBoard { top: 2%; left: 2%; }
#levelBoard { top: 2%; right: 2%; }
#livesBoard { top: 8%; left: 2%; }

#gameOverMessage {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: red;
    font-size: 8vw;
    font-weight: bold;
    display: none;
    text-align: center;
}

#startButton, #restartButton, #shootButton {
    position: absolute;
    padding: 1% 2%;
    font-size: 4vw;
    cursor: pointer;
    border: none;
    border-radius: 8px;
    color: white;
}

#startButton { top: 60%; left: 50%; transform: translate(-50%, -50%); background-color: #28a745; }
#restartButton { top: 60%; left: 50%; transform: translate(-50%, -50%); background-color: #007bff; display: none; }
#shootButton { bottom: 5%; right: 5%; width: 20%; height: 8%; font-size: 4vw; background-color: #dc3545; }

.cloud {
    position: absolute;
    width: 10%;
    height: 10%;
    max-width: 100px;
    max-height: 60px;
    background: white;
    border-radius: 50%;
    opacity: 0.8;
    animation: moveClouds linear infinite;
}

@keyframes moveClouds {
    from { transform: translateX(-15%); }
    to { transform: translateX(115%); }
}
</style>
</head>
<body>
<div id="gameContainer">
    <div id="player"></div>
    <div id="scoreBoard">Skor: <span id="score">0</span></div>
    <div id="levelBoard">Seviye: <span id="level">1</span></div>
    <div id="livesBoard">Can: <span id="lives">5</span></div>
    <div id="gameOverMessage">OYUN BİTTİ</div>
    <button id="startButton">Başlat</button>
    <button id="restartButton">Yeniden Oyna</button>
    <button id="shootButton">Ateş Et</button>
</div>

<script>
let player;
let bullets = [];
let enemies = [];
let score = 0;
let gameInterval;
let enemyInterval;
let speedInterval;
let gameStarted = false;
let enemySpeed = 2;
let level = 1;
let lives = 5;
const gameArea = document.getElementById('gameContainer');

let lastShotTime = 0;
const gameOverMessage = document.getElementById('gameOverMessage');
const startButton = document.getElementById('startButton');
const restartButton = document.getElementById('restartButton');
const shootButton = document.getElementById('shootButton');

startButton.addEventListener('click', () => { addClouds(); startGame(); });
restartButton.addEventListener('click', restartGame);
shootButton.addEventListener('click', shoot);

// --- Mobil dokunmatik kontroller ---
let touchStartX = null;
let touchMoveX = null;

gameArea.addEventListener('touchstart', function(e) {
    if (!gameStarted) return;
    touchStartX = e.touches[0].clientX;
});

gameArea.addEventListener('touchmove', function(e) {
    if (!gameStarted) return;
    touchMoveX = e.touches[0].clientX;
    const diff = (touchMoveX - touchStartX) * (gameArea.offsetWidth / window.innerWidth); // ölçekli hareket
    movePlayer(diff);
    touchStartX = touchMoveX;
});

function movePlayer(direction) {
    let currentLeft = parseFloat(player.style.left) || player.offsetLeft;
    let newLeft = currentLeft + direction;
    if (newLeft < 0) newLeft = 0;
    if (newLeft > gameArea.offsetWidth - player.offsetWidth) newLeft = gameArea.offsetWidth - player.offsetWidth;
    player.style.left = newLeft + 'px';
}

function shoot() {
    const now = Date.now();
    if (now - lastShotTime > 250) {
        const bullet = document.createElement('div');
        bullet.classList.add('bullet');
        bullet.style.left = player.offsetLeft + player.offsetWidth/2 - gameArea.offsetWidth*0.006/2 + 'px';
        bullet.style.bottom = player.offsetHeight + 5 + 'px';
        gameArea.appendChild(bullet);
        bullets.push(bullet);
        lastShotTime = now;
    }
}

function addClouds() {
    for(let i=0; i<5; i++) {
        const cloud = document.createElement('div');
        cloud.classList.add('cloud');
        cloud.style.top = Math.random() * 30 + '%';
        cloud.style.left = Math.random() * 100 + '%';
        cloud.style.animationDuration = (30 + Math.random() * 20) + 's';
        gameArea.appendChild(cloud);
    }
}

function startGame() {
    gameStarted = true;
    score = 0;
    level = 1;
    enemySpeed = 2;
    lives = 5;
    document.getElementById('score').innerText = score;
    document.getElementById('level').innerText = level;
    document.getElementById('lives').innerText = lives;
    startButton.style.display = 'none';
    restartButton.style.display = 'none';
    gameOverMessage.style.display = 'none';
    player = document.getElementById('player');
    player.style.left = '50%';
    player.style.transform = 'translateX(-50%)';
    gameInterval = setInterval(gameLoop, 20);
    enemyInterval = setInterval(spawnEnemy, 1000);
    speedInterval = setInterval(increaseDifficulty, 30000);
}

function restartGame() {
    clearInterval(gameInterval);
    clearInterval(enemyInterval);
    clearInterval(speedInterval);
    bullets.forEach(b => b.remove());
    enemies.forEach(e => e.remove());
    bullets = [];
    enemies = [];
    addClouds();
    startGame();
}

function gameLoop() {
    moveBullets();
    moveEnemies();
    checkCollisions();
}

function moveBullets() {
    bullets.forEach((bullet, index) => {
        bullet.style.bottom = (parseFloat(bullet.style.bottom) + 5) + 'px';
        if (parseFloat(bullet.style.bottom) > gameArea.offsetHeight) {
            bullet.remove();
            bullets.splice(index, 1);
        }
    });
}

function moveEnemies() {
    enemies.forEach((enemy, index) => {
        enemy.style.top = (parseFloat(enemy.style.top) || 0) + enemySpeed + 'px';
        if (parseFloat(enemy.style.top) > gameArea.offsetHeight) {
            enemy.remove();
            enemies.splice(index, 1);
            lives--;
            document.getElementById('lives').innerText = lives;
            if (lives <= 0) endGame();
        }
    });
}

function spawnEnemy() {
    const enemy = document.createElement('div');
    enemy.classList.add('enemy');
    enemy.style.left = Math.random() * (gameArea.offsetWidth - enemy.offsetWidth) + 'px';
    enemy.style.top = '0px';
    gameArea.appendChild(enemy);
    enemies.push(enemy);
}

function increaseDifficulty() {
    enemySpeed += 1;
    level += 1;
    document.getElementById('level').innerText = level;
}

function checkCollisions() {
    bullets.forEach((bullet, bulletIndex) => {
        enemies.forEach((enemy, enemyIndex) => {
            if (isColliding(bullet, enemy)) {
                bullet.remove();
                enemy.remove();
                bullets.splice(bulletIndex, 1);
                enemies.splice(enemyIndex, 1);
                score++;
                document.getElementById('score').innerText = score;
            }
        });
    });

    enemies.forEach((enemy, enemyIndex) => {
        if (isColliding(player, enemy)) {
            enemy.remove();
            enemies.splice(enemyIndex, 1);
            lives--;
            document.getElementById('lives').innerText = lives;
            if (lives <= 0) endGame();
        }
    });
}

function endGame() {
    clearInterval(gameInterval);
    clearInterval(enemyInterval);
    clearInterval(speedInterval);
    bullets.forEach(b => b.remove());
    enemies.forEach(e => e.remove());
    bullets = [];
    enemies = [];
    gameOverMessage.style.display = 'block';
    restartButton.style.display = 'block';
}

function isColliding(a, b) {
    const rectA = a.getBoundingClientRect();
    const rectB = b.getBoundingClientRect();
    return !(
        rectA.top > rectB.bottom ||
        rectA.bottom < rectB.top ||
        rectA.right < rectB.left ||
        rectA.left > rectB.right
    );
}
</script>
</body>
</html>
